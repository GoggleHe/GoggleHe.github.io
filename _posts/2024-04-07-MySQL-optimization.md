---
layout: post
title: MySQL优化
categories: [MySQL]
description: MySQL优化
keywords: MySQL
---

## MySQL优化

### 调优思路

1. 硬件优化
2. 数据库设计与规划--以后再修改很麻烦，估计数据量，使用什么存储引擎
3. 数据的应用--怎样取数据，SQL语句的优化
4. 磁盘 IO优化
5. 操作系统的优化--内核、TCP连接数量
6. MySQL服务优化--内存的使用，磁盘的使用
7. my.cnf 内参数的优化
8. 分库分表思路和优劣

### MySQL资源分配参考

| CPU资源         | 物理机内存 | 分配给系统的内存 | 分配给mysql的内存 |
| --------------- | ---------- | ---------------- | ----------------- |
| 系统和mysql共用 | 8G         | 2G               | 6G                |
| 系统和mysql共用 | 16G        | 4G               | 12G               |
| 系统和mysql共用 | 32G        | 8G               | 24G               |
| 系统和mysql共用 | 64G        | 8G               | 56G               |
| 系统和mysql共用 | 128G       | 8G               | 120G              |
| 系统和mysql共用 | 以此类推   | 以此类推         | 以此类推          |

### 硬件优化

- CPU—— 64 位、高主频、高缓存，高并行处理能力
- 内存——大内存、主频高，尽量不要用 SWAP
- 硬盘——15000转、RAID5、raid10 。 SSD
- 网络——标配的千兆网卡，10G网卡，bond，team MySQL服务器尽可能和使用它的web服务器在同一局域网内，尽量避免诸如防火墙策略等不必要的开销

### 数据库设计与规划（架构上的优化)

**纵向拆解**: 专机专用

例：现在公司一台服务器同时负责 web、ftp、数据库等多个角色。当web服务器把cpu占满了，mysql服务也没有办法运行了。一个服务坏了，全所有服务全坏。

纵向拆解后就是：数据库服务器专机专用，避免额外的服务可能导致的性能下降和不稳定性。

**横向拆解**:当单个 MySQL数据库无法满足日益增加的需求时，可以考虑在数据库这个逻辑层面增加多台服务器，以达到稳定、高效的效果。比如：使用主从读写分离、MHA，MGR等技术。